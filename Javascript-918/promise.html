<!DOCTYPE html>
<!-- saved from url=(0081)http://code.tarena.com.cn/WEBCode/wfd1707/08_JAVASCRIPTCORE/day09/06_promise.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=GBK">
  
  <title>Document</title>
 </head>
 <body>
  <script src="./promise_files/ajax.js.обть"></script>
  <script>
function conn(){            // then    catch
  return new Promise((resolve,reject)=>{
    ajax("get","05-1-conn.php","","text")
    .then(text=>{
      var r=Math.random()>0.2;
      if(r){
        console.log(text);
        resolve();
      }else
        reject("Х©·Ф▌╔Е┤╨И■≥!");
    });
  });
}
function query(){
  return new Promise((resolve,reject)=>{
    ajax("get","05-2-query.php","","text")
    .then(text=>{
      var r=Math.random()>0.2;
      if(r){
        console.log(text);
        resolve();
      }else
        reject("Ф÷╔Х╞╒Е┤╨И■≥!");
    });
  });
}
function response(){
  return new Promise((resolve,reject)=>{
    ajax("get","05-3-response.php","","text")
    .then(text=>{
      var r=Math.random()>0.2;
      if(r){
        console.log(text);
        resolve();
      }else
        reject("Х©■Е⌡·Е⌠█Е╨■Е┤╨И■≥!");
    });
  })
}
function end(){ console.log("Ф⌠█Д╫°Е╝▄Ф┬░!"); }
conn()/*Ф┼⌡Е┤╨Ф┴©Х╞╨*/  
.then(query)/*Е╟├queryФ■╬Е┘╔Ф┴©Х╞╨Д╦╜Г╜┴Е╬┘Ф┴╖Х║&#65533;*/
/*queryФ┴╖Х║▄Е░▌О╪▄Е▐┬Ф┼⌡Е┤╨Ф√╟Г └Ф┴©Х╞&#65533;*/
.then(response)/*Е╟├responseФ■╬Е┘╔Ф┴©Х╞╨Д╦╜Г╜┴Е╬┘Ф┴╖Х║&#65533;*/
/*responseФ┴╖Х║▄Е░▌О╪▄Е▐┬Ф┼⌡Е┤╨Ф√╟Г └Ф┴©Х╞&#65533;*/
.then(end)/*Е╟├endФ■╬Е┘╔Ф┴©Х╞╨Д╦╜Г╜┴Е╬┘Ф┴╖Х║&#65533;*/
/*Д╧▀Е┴█Д╩╩Д╫∙Д╦─Д╦╙thenЕ┤╨И■≥О╪▄Е░▌Г╩╜thenД╦█Е├█Ф┴╖Х║▄О╪▄Х─▄Ф≤╞Х┤╙Е┼╗Е┬╟Г╩⌠Е╟╬Х╟┐Г■╗catch*/
.catch(err=>console.log(err))
/*Ф┼⌡Е┤╨Ф┴©Х╞╨,Г└╤Е░▌Е╟├Е░▌Г╩╜Е┤╫Ф∙╟Ф■╬Е┘╔Ф┴©Х╞╨Д╦╜Г╜┴Е╬┘Ф┴╖Х║▄*/
  </script>
 

</body></html>